{{ 'customer.css' | asset_url | stylesheet_tag }}

{%- style -%}
.original-shopify-order-status-page,
.line-item-table{
/* display:none; */
}
.section-{{ section.id }}-padding {
padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
}

.shipping-address,
.bill-address {
box-sizing: border-box;
border: 1px solid #ccc; /* æ·»åŠ è¾¹æ¡† */
border-radius: 4px; /* æ·»åŠ åœ†è§’ */
background:white;
}

/* è¢å¹•å¯¬åº¦å¤§æ–¼751PXæ™‚ */
@media screen and (min-width: 751px) {
.section-{{ section.id }}-padding {
padding-top: {{ section.settings.padding_top }}px;
padding-bottom: {{ section.settings.padding_bottom }}px;
}
.shipping-address,
.bill-address {
margin-top:5rem;
margin-bottom:2rem;
padding-top:1rem;
padding-left:2rem;
}
.step1-icon,
.step2-icon,
.step3-icon,
.step4-icon {
font-size:64px !important;
user-select: none; /* ç¦æ­¢é€‰æ‹© */

}
}

/* è¢å¹•å¯¬åº¦å°æ–¼751PXæ™‚ */
@media (max-width: 751px) {
.shipping-address,
.bill-address {
width: 100%; /* å°å±å¹•ä¸‹æ¯ä¸ªåœ°å€å æ»¡å®½åº¦ */
margin-top:0rem;
padding-top:0rem;
padding-left:2rem;
}
.step1-icon,
.step2-icon,
.step3-icon,
.step4-icon {
font-size:32px !important;
user-select: none; /* ç¦æ­¢é€‰æ‹© */
}
}

/* é€²åº¦æ¢çš„CSSä»£ç¢¼ */


body {
color: #000;
overflow-x: hidden;
height: 100%;
background-color: #8C9EFF;
background-repeat: no-repeat;
}

.card {
z-index: 0;
/* background-color: #ECEFF1; */
/*
#FFF5F8 (Lighter Tint of Pink): æœ€æ¥è¿‘ç™½è‰²ï¼Œéå¸¸æŸ”å’Œã€‚é€‚åˆæ­é…æ·±è‰²æ–‡å­—ï¼Œè¥é€ ç®€æ´ã€æ¸…æ–°çš„æ„Ÿè§‰ã€‚
#FFE5E8 (Light Pink): ç¨å¾®åŠ æ·±ä¸€ç‚¹ï¼Œä½†ä»å¾ˆæ·¡é›…ã€‚é€‚åˆæ­é…æ·±ç°è‰²æˆ–é»‘è‰²æ–‡å­—ï¼Œå…¼é¡¾ç¾è§‚ä¸æ˜“è¯»æ€§ã€‚
#FFD6D9 (Soft Pink): æ˜äº®åº¦é€‚ä¸­ï¼Œèƒ½å‡¸æ˜¾è¡¨æ ¼å†…å®¹ã€‚æ­é…æ·±ç°è‰²æ–‡å­—æ•ˆæœè¾ƒå¥½ã€‚
#FFCCE0 (Peachy Pink): åæš–è‰²è°ƒï¼Œå¸¦æ¥æ¸©é¦¨æ„Ÿã€‚ä½†æ³¨æ„æ­é…æ–‡å­—é¢œè‰²ï¼Œé¿å…å¯¹æ¯”åº¦ä¸è¶³ã€‚
#FFB6C1 (Light Pink): æ›´æ·±çš„ç²‰è‰²ï¼Œèƒ½è¥é€ æ´»æ³¼æ„Ÿã€‚ä½†ä½œä¸ºå¤§é¢ç§¯åº•è‰²å¯èƒ½ä¼šè¿‡äºæŠ¢çœ¼ï¼Œå»ºè®®å°é¢ç§¯ä½¿ç”¨ã€‚
*/
background-color:#FFF5F8 ;
border-radius: 10px;
}

.top {
padding-left: 10% !important;
padding-right: 10% !important;
}


/*Icon progressbar*/
#progressbar {
margin-bottom: 30px;
overflow: hidden;
color: #455A64;
padding-left: 0px;
margin-top: 30px;
}

#progressbar li {
list-style-type: none;
font-size: 13px;
width: 25%;
float: left;
position: relative;
font-weight: 400;
}

#progressbar .step0:before {
content: "âœ¦";
/* content: 'ğŸª'; */
font-size:24px;
color: #fff;
}

#progressbar li:before {
content: '';
width: 40px;
height: 40px;
line-height: 45px;
display: block;
background-color: #C5CAE9; /* è®¾ç½®ä¸ºç²‰è‰² */
border-radius: 50%;
margin: 0 auto;
/*
width: 40px;
height: 40px;
line-height: 45px;
display: block;
font-size: 20px;
background: #C5CAE9;
border-radius: 50%;
margin: auto;
padding: 0px;
*/
}


/*ProgressBar connectors*/
#progressbar li:after {
content: '';
width: 100%;
height: 12px;
background: #C5CAE9;
position: absolute;
left: 0;
top: 16px;
z-index: -1;
}

#progressbar li:last-child:after {
border-top-right-radius: 10px;
border-bottom-right-radius: 10px;
position: absolute;
left: -50%;
}

#progressbar li:nth-child(2):after, #progressbar li:nth-child(3):after {
left: -50%;
}

#progressbar li:first-child:after {
border-top-left-radius: 10px;
border-bottom-left-radius: 10px;
position: absolute;
left: 50%;
}

#progressbar li:last-child:after {
border-top-right-radius: 10px;
border-bottom-right-radius: 10px;
}

#progressbar li:first-child:after {
border-top-left-radius: 10px;
border-bottom-left-radius: 10px;
}

/*Color number of the step and the connector before it*/
#progressbar li.active:before, #progressbar li.active:after {
background: blue;
}

#progressbar li.active:before {
content: "âœ“";
font-size: 32px;
font-color: white;
background-color: blue; /* æ¿€æ´»çŠ¶æ€çš„è“è‰² */
}

.icon {
width: 60px;
height: 60px;
margin-right: 15px;
}

.icon-content {
padding-bottom: 20px;
}

@media screen and (max-width: 992px) {
.icon-content {
width: 50%;
}
}

#progressbar li:not(.active) p { /* é’ˆå¯¹æœªæ¿€æ´»çŠ¶æ€çš„ <li> ä¸­çš„ <p> */
    opacity: 0.2; /* è®¾ç½®ä¸ºåŠé€æ˜ */
    transition: opacity 0.3s ease; /* æ·»åŠ è¿‡æ¸¡æ•ˆæœ */
    }

    #progressbar li.active p {
    opacity: 1;
    }

    /* åœ¨æ‚¨çš„ theme.scss.liquid æ–‡ä»¶ä¸­ */
    .order-notes {
    padding: 15px;
    border: 1px solid #ddd;
    border-radius: 4px;
    width: 80%; /* æ¡Œé¢ç«¯å®½åº¦ä¸º 80% */
    margin-left: 0; /* æ°´å¹³å±…ä¸­ */
    margin-right: auto; /* æ°´å¹³å±…ä¸­ */
    background: white;
    }

    /* ç§»é™¤ btn hover å’Œ active æ¨£å¼ */
    .btn:hover,
    .btn:active {
    background-color: transparent !important;
    border-color: transparent !important;
    box-shadow: none !important;
    }

    .order-summary-table img {
    border-radius: 10px; /* è¨­å®šåœ“è§’åŠå¾‘ */
    }

    /* åœ–ç‰‡ hover æ¨£å¼ */
    .order-summary-table img {
    cursor: pointer; /* æ»‘é¼ è®Šæˆæ‰‹å‹ */
    transition: opacity 0.3s ease; /* æ·»åŠ éæ¸¡æ•ˆæœ */
    }

    .order-summary-table img:hover {
    opacity: 0.5; /* è®Šæ·¡ */
    }

    @media screen and (min-width: 750px) {
    /* åœ¨ order-summary-table.css æ–‡ä»¶ä¸­ */
    .order-summary-table thead th, /* é’ˆå¯¹è®¢å•åˆ—è¡¨çš„è¡¨å¤´ */
    .order-summary-table tbody td { /* é’ˆå¯¹è®¢å•åˆ—è¡¨çš„å•å…ƒæ ¼ */
    padding: 0;
    }

    /* 1, 2, 4, 5, 6 åˆ—çš„ th å…ƒç´ æ–‡æœ¬å±…ä¸­ */
    .order thead th:nth-child(1),
    .order thead th:nth-child(2),
    .order thead th:nth-child(4),
    .order thead th:nth-child(5),
    .order thead th:nth-child(6) {
    text-align: center;
    }

    /* ç¬¬ä¸‰åˆ—çš„ th å…ƒç´ æ–‡æœ¬é å·¦ */
    .order thead th:nth-child(3) {
    text-align: left;
    }

    /* é’ˆå¯¹è®¢å•åˆ—è¡¨è¡¨æ ¼ç¬¬ä¸€åˆ—çš„è¡¨å¤´å’Œå•å…ƒæ ¼ */
    .order-summary-table th:first-of-type,
    .order-summary-table td:first-of-type {
    padding-left: 0;
    }
    .order-summary-table tbody td:first-of-type {
    padding-top: 0;
    }

    .order-summary-table .customer td:first-of-type {
    padding-right: 0;
    }
    }

    /* åœ¨ order-summary-table.css æ–‡ä»¶ä¸­ */
    @media screen and (max-width: 750px) {
    .order-summary-table td:before {
    display: none; /* éš±è— ::before å½å…ƒç´  */
    text-align:right;
    }
    tbody td:last-of-type {
    padding-bottom: 2rem;
    }
    tbody td:first-of-type {
    padding-top: 2rem;
    }
    /* é’ˆå¯¹è®¢å•åˆ—è¡¨è¡¨æ ¼ä¸­ç‰¹å®šçš„ td */
    .order-summary-table td:nth-child(4) {
    text-align: right;
    }
    tbody tr {
    border-top:0 !important;
    }
    }



    {%- endstyle -%}

    <script>
      {% assign order_status = order.metafields.custom.order_status %}
      {% assign order_progress = 0 %}

      {% case order_status %}
      {% when 'Partially Paid - Unconfirmed', 'Partially Paid - Confirmed', 'Paid in Full - Unconfirmed', 'Paid in Full - Confirmed' %}
      {% assign order_progress = 25 %}
      {% when 'Unfulfilled', 'Partially Fulfilled', 'Fulfilled' %}
      {% assign order_progress = 50 %}
      {% when 'Not Delivered', 'Partially Delivered' %}
      {% assign order_progress = 75 %}
      {% when 'Delivered', 'Completed', 'Returned - Refunded', 'Returned - Not Refunded', 'On Hold' %}
      {% assign order_progress = 100 %}
      {% when 'Failed', 'Cancelled' %}
      {% assign order_progress = 0 %}
      {% when 'Order Created' %}
      {% assign order_progress = 100 %}
      {% endcase %}

      document.addEventListener('DOMContentLoaded', function () {
        const toggleButtons = document.querySelectorAll('[data-bs-toggle="collapse"]');

        toggleButtons.forEach(button => {
          button.addEventListener('click', () => {
            const targetId = button.getAttribute('data-bs-target');
            const targetTbody = document.querySelector(targetId);
            const collectionTitle = button.closest('tr').querySelector('.collection-title'); // æ‰¾åˆ°æœ€è¿‘çš„ tr ä¸­çš„ .collection-title

            if (!targetTbody) {
              console.error(`Element with ID ${targetId} not found.`);
              return;
            }

            // å¦‚æœç›®æ¨™å…ƒç´ å·²ç¶“åœ¨éæ¸¡éç¨‹ä¸­ï¼Œä¸é€²è¡Œæ“ä½œ
            if (targetTbody.classList.contains('collapsing')) {
              return;
            }

            // æª¢æŸ¥ç•¶å‰ç‹€æ…‹ï¼Œç„¶å¾Œåˆ‡æ› class
            if (targetTbody.classList.contains('show')) {
              targetTbody.classList.remove('show');
              targetTbody.classList.remove('expand');
              targetTbody.classList.add('collapse');
              collectionTitle.setAttribute('colspan', '5'); // åœ¨æŠ˜ç–Šå®Œæˆåè®¾ç½® colspan
            } else {
              targetTbody.classList.remove('collapse');
              targetTbody.classList.add('show');
              targetTbody.classList.add('expand');
              collectionTitle.removeAttribute('colspan');
            }
          });
        });

        // è™•ç†éæ¸¡å®Œæˆäº‹ä»¶
        const targetTbodies = document.querySelectorAll('[id^="targetTbody"]');
        targetTbodies.forEach(targetTbody => {
          targetTbody.addEventListener('animationend', function () {
            const button = document.querySelector(`[data-bs-target="#${targetTbody.id}"]`);
            const collectionTitle = button.closest('tr').querySelector('.collection-title');
            if (targetTbody.classList.contains('show')) {
              collectionTitle.removeAttribute('colspan');
            } else {
              collectionTitle.setAttribute('colspan', '5'); // åœ¨æŠ˜ç–Šå®Œæˆåè®¾ç½® colspan
            }
          });
        });

        var imageModal = document.getElementById('imageModal');
        imageModal.addEventListener('show.bs.modal', function (event) {
          var button = event.relatedTarget;
          var imgSrc = button.getAttribute('data-img-src');
          var imgAlt = button.getAttribute('data-img-alt');

          var modalImg = imageModal.querySelector('.modal-body img');
          modalImg.src = imgSrc;
          modalImg.alt = imgAlt;
        });

        // åˆå§‹å±•é–‹æ‰€æœ‰ç›®æ¨™è¡¨æ ¼
        const collapsibleElements = document.querySelectorAll('.collapse');
        collapsibleElements.forEach(element => {
          element.classList.add('show');
          element.classList.add('expand');
        });
      });

    </script>

  <div class="customer order section-{{ section.id }}-padding">
    <svg style="display:none">
      <symbol id="icon-discount" viewBox="0 0 12 12">
        <path fill-rule="evenodd" clip-rule="evenodd"
          d="M7 0h3a2 2 0 012 2v3a1 1 0 01-.3.7l-6 6a1 1 0 01-1.4 0l-4-4a1 1 0 010-1.4l6-6A1 1 0 017 0zm2 2a1 1 0 102 0 1 1 0 00-2 0z"
          fill="currentColor">
      </symbol>
    </svg>

    <div>
      <!-- å¸³è™Ÿé é¢çš„æ¨™é¡Œé¡¯ç¤ºï¼Œé è¨­"Account" -->
      <h1 class="customer__title">{{ 'customer.account.title' | t }}</h1>
      <a href="{{ routes.account_url }}">{{ 'customer.account.return' | t }}</a>
    </div>
    <!-- Start again from here.... -->
    <div class="card">
      <div class="row d-flex flex-wrap justify-content-between px-3 top">
        <div class="d-flex flex-column flex-md-row">
          <div class="flex-grow-1">
            <div style="text-align: left;margin-bottom:10px">
              <p>
                <!-- è¨‚å–®æ¨™é¡Œï¼Œé¡¯ç¤ºè¨‚å–®åç¨± -->
              <h1>{{ 'customer.order.title' | t: name: order.name }}</h1>
              </p>
              {% if order_status != null %}
              <p class="badge badge-light">Currentlly Status : {{ order_status }}</p>
              <br>
              {% endif %}

              <p class="badge badge-light">
                <!-- ä»˜æ¬¾ç‹€æ…‹ -->
                {{ 'customer.order.payment_status' | t }}: {{ order.financial_status_label }}
              </p>
              <br>
              <p class="badge badge-light">
                <!-- å•†å“é…é€ç‹€æ…‹ -->
                {{ 'customer.order.fulfillment_status' | t }}:{{ order.fulfillment_status_label }}
              </p>
              {% if order.note != null %}
              <div class="order-notes">
                <h2>Note from BabygliderPH :</h2>
                <p style="font-size:18px;">{{ order.note }}</p>
              </div>
              {% endif %}
            </div>
          </div>
          <div class="flex-grow-1 shipping-address">
            <div>
              <!-- é¡¯ç¤ºé‹é€åœ°å€ -->
              <p style="font-size:24px;">{{ 'customer.order.shipping_address' | t }}</p>
              {{ order.shipping_address | format_address }}
              <p>
                Phone :
                {%- liquid
                if order.shipping_address.phone
                echo order.shipping_address.phone
                elsif order.billing_address.phone
                echo order.billing_address.phone
                else
                echo customer.phone
                endif
                %}
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Add class 'active' to progress -->
      <div class="row d-flex justify-content-center">
        <div class="col-12">
          <ul id="progressbar" class="text-center">
            <li class="step0 active">
              <p class="step1-icon" style="margin-bottom: 0;">ğŸ“‹</p>
              <p>
                Order Placed at<br>
                {%- assign order_date = order.created_at | time_tag: format: 'date_at_time' -%}
                {{ order_date }}
              </p>
            </li>
            <li class="step0 {% if order_progress >= 50 %}active{% endif %}">
              <p class="step2-icon" style=" margin-bottom: 0;">ğŸ’³</p>
              <p>Paid</p>
            </li>
            <li class="step0 {% if order_progress >= 75 %}active{% endif %}">
              <p class="step3-icon" style=" margin-bottom: 0;">ğŸšš</p>
              <p>Shipped/In Transit</p>
            </li>
            <li class="step0 {% if order_progress == 100 %}active{% endif %}">
              <p class="step4-icon" style=" margin-bottom: 0;">ğŸŒŸ</p>
              <p>Completed!</p>
            </li>
          </ul>
        </div>
      </div>
    </div>

    {% comment %} æ‘ºç–Šè¡¨æ ¼ {% endcomment %}
    {% assign sorted_items = order.line_items | sort: 'product.collections[0].title' %}
    {% assign current_collection = null %}
    <h2>{{ order.name }} Order List</h2>

    {% comment %} PC Table {% endcomment %}
    <table class="table order-summary-table d-none d-md-table" style="padding: 0%;">
      <thead>
        <tr class="text-center align-middle">
          <th class="py-4 fs-4" style="width: 40px;"></th>
          <th class="py-4 fs-4" style="width: 100px;">Image</th>
          <th class="py-4 fs-4 ps-3">Product Info</th>
          <th class="py-4 fs-4" style="width: 100px;">Price</th>
          <th class="py-4 fs-4" style="width: 40px;">Qty</th>
          <th class="py-4 fs-4" style="width: 100px;">Total</th>
        </tr>
      </thead>
      <tbody>
        {% assign current_collection = '' %}
        {% for line_item in sorted_items %}
        {% assign collection = line_item.product.collections[0].title %}
        {% if collection contains '[Pre-Order]' %}
        {% if collection != current_collection %}
        {% if current_collection != '' %}
      </tbody>
      {% endif %}
      {% assign current_collection = collection %}
      <tr>
        <td class="text-center align-middle" style="padding-right:0;">
          <a class="btn btn-primary toggle-button text-decoration-none" data-bs-toggle="collapse"
            data-bs-target="#collapse{{ forloop.index }}" href="#collapse{{ forloop.index }}" role="button"
            aria-expanded="true" aria-controls="collapse{{ forloop.index }}">
            â•
          </a>
        </td>
        <td class="collection-title p-0 align-middle fs-3" colspan="6" style="background-color:lightgoldenrodyellow;">
          <div class="text-start py-3" colspan="6">
            {{ collection }}
            {%- assign product = line_item.product -%}
            {%- assign collection_handle = product.collections[0].handle -%}
            {%- assign shopify_collection = collections[collection_handle] -%}
            {% if shopify_collection.metafields.custom.estimated_time_of_arrival %}
            <span class="badge rounded-pill text-white bg-primary text-center align-middle">
              ETA: {{ shopify_collection.metafields.custom.estimated_time_of_arrival | date: '%Y-%m-%d' }}
            </span>
            {% endif %}
          </div>
        </td>
      </tr>
      <tbody id="collapse{{ forloop.index }}" class="collapse">
        {% endif %}
        <tr>
          <td></td>
          <td class="p-0 text-center align-middle">
            <img src="{{ line_item.image | image_url: width: 100, height: 100 }}" alt="{{ line_item.title }}"
              width="100" height="100" class="clickable-img" data-bs-toggle="modal" data-bs-target="#imageModal"
              data-img-src="{{ line_item.image | image_url }}" data-img-alt="{{ line_item.title }}">
          </td>
          {% comment %} <td class="ps-3 align-middle">{{ line_item.product.title }}</td> {% endcomment %}
          <td class="ps-3 align-top" id="Row{{ line_item.key }}" headers="ColumnProduct" role="rowheader" scope="row"
            data-label="{{ 'customer.order.product' | t }}">
            <div>
              {%- if line_item.url != blank -%}
              <!-- å¦‚æœç”¢å“æœ‰URLï¼Œé¡¯ç¤ºç‚ºå¯é»æ“Šéˆæ¥ -->
              <a href="{{ line_item.url }}">{{ line_item.title }}</a>
              {%- else -%}
              <!-- å¦å‰‡é¡¯ç¤ºç‚ºæ™®é€šæ–‡æœ¬ -->
              <p>{{ line_item.title }}</p>
              {%- endif -%}
              {%- assign property_size = line_item.properties | size -%}
              {%- unless line_item.selling_plan_allocation == null and property_size == 0 -%}
              <div class="properties">
                {%- unless line_item.product.has_only_default_variant -%}
                <!-- å¦‚æœç”¢å“æœ‰è®Šé«”ï¼Œé¡¯ç¤ºè®Šé«”åç¨± -->
                <span>
                  {{ line_item.variant.title }}
                </span>
                {%- endunless -%}
                {%- unless line_item.selling_plan_allocation == null -%}
                <!-- å¦‚æœæœ‰éŠ·å”®è¨ˆåŠƒï¼Œé¡¯ç¤ºè¨ˆåŠƒåç¨± -->
                <span>
                  {{ line_item.selling_plan_allocation.selling_plan.name }}
                </span>
                {%- endunless -%}
                {%- if property_size != 0 -%}
                <!-- é¡¯ç¤ºç”¢å“å±¬æ€§ -->
                {%- for property in line_item.properties -%}
                {% assign property_first_char = property.first | slice: 0 %}
                {%- if property.last != blank and property_first_char != '_' -%}
                <span>{{ property.first }}:</span>
                <span>
                  {%- if property.last contains '/uploads/' -%}
                  <a href="{{ property.last }}">{{ property.last | split: '/' | last }}</a>
                  {%- else -%}
                  {{ property.last }}
                  {%- endif -%}
                </span>
                {%- endif -%}
                {%- endfor -%}
                {%- endif -%}
              </div>
              {%- endunless -%}

              {%- if line_item.line_level_discount_allocations != blank -%}
              <!-- å¦‚æœæœ‰æŠ˜æ‰£ï¼Œé¡¯ç¤ºæŠ˜æ‰£ä¿¡æ¯ -->
              <ul role="list" aria-label="{{ 'customer.order.discount' | t }}">
                {%- for discount_allocation in line_item.line_level_discount_allocations -%}
                <li>
                  <svg aria-hidden="true" focusable="false" viewBox="0 0 12 12">
                    <use href="#icon-discount" />
                  </svg>
                  {{- discount_allocation.discount_application.title }} (-
                  {{- discount_allocation.amount | money -}}
                  )
                </li>
                {%- endfor -%}
              </ul>
              {%- endif -%}

              {%- if line_item.fulfillment -%}
              <div class="fulfillment">
                {%- assign created_at = line_item.fulfillment.created_at | time_tag: format: 'date' -%}
                <!-- é¡¯ç¤ºå±¥è¡Œæ—¥æœŸ -->
                <span>{{ 'customer.order.fulfilled_at_html' | t: date: created_at }}</span>

                {%- if line_item.fulfillment.tracking_url -%}
                <!-- å¦‚æœæœ‰è¿½è¹¤URLï¼Œé¡¯ç¤ºè¿½è¹¤éˆæ¥ -->
                <a href="{{ line_item.fulfillment.tracking_url }}">
                  {{ 'customer.order.track_shipment' | t }}
                </a>
                {%- endif -%}
                <span>
                  {{ line_item.fulfillment.tracking_company }}
                  {%- if line_item.fulfillment.tracking_number -%}
                  #{{ line_item.fulfillment.tracking_number }}
                  {%- endif -%}
                </span>
              </div>
              {%- endif -%}
            </div>
          </td>
          {% comment %} <td class="pe-4 align-middle">{{ line_item.price | money }}</td> {% endcomment %}
          <td class="pe-4 align-middle" headers="Row{{ line_item.key }} ColumnPrice" role="cell" data-label="{{ 'customer.order.price' | t }}">
            <!-- é¡¯ç¤ºç”¢å“åƒ¹æ ¼ï¼Œå¦‚æœæœ‰æŠ˜æ‰£é¡¯ç¤ºæŠ˜æ‰£å¾Œåƒ¹æ ¼ -->
            {%- if line_item.original_price != line_item.final_price or line_item.unit_price_measurement -%}
            <dl>
              {%- if line_item.original_price != line_item.final_price -%}
              <dt>
                <span class="visually-hidden">{{ 'products.product.price.regular_price' | t }}</span>
              </dt>
              <dd class="regular-price">
                <s>{{ line_item.original_price | money }}</s>
              </dd>
              <dt>
                <span class="visually-hidden">{{ 'products.product.price.sale_price' | t }}</span>
              </dt>
              <dd>
                <span>{{ line_item.final_price | money }}</span>
              </dd>
              {%- else -%}
              <dt>
                <span class="visually-hidden">{{ 'products.product.price.regular_price' | t }}</span>
              </dt>
              <dd>
                {{ line_item.original_price | money }}
              </dd>
              {%- endif -%}
              {%- if line_item.unit_price_measurement -%}
              <dt>
                <span class="visually-hidden">{{ 'products.product.price.unit_price' | t }}</span>
              </dt>
              <dd class="unit-price">
                <span>
                  {%- capture unit_price_separator -%}
                  <span aria-hidden="true">/</span><span class="visually-hidden">{{
                    'accessibility.unit_price_separator' | t }}&nbsp;</span>
                  {%- endcapture -%}
                  {%- capture unit_price_base_unit -%}
                  {%- if line_item.unit_price_measurement.reference_value != 1 -%}
                  {{- line_item.unit_price_measurement.reference_value -}}
                  {%- endif -%}
                  {{ line_item.unit_price_measurement.reference_unit }}
                  {%- endcapture -%}
                  <span data-unit-price>{{ line_item.unit_price | money }}</span>
                  {{- unit_price_separator -}}
                  {{- unit_price_base_unit -}}
                </span>
              </dd>
              {%- endif -%}
            </dl>
            {%- else -%}
            <span>{{ line_item.final_price | money }}</span>
            {%- endif -%}
          </td>
          {% comment %} <td class="text-center align-middle">x{{ line_item.quantity }}</td> {% endcomment %}
          <td
            class="text-center align-middle"
            headers="Row{{ line_item.key }} ColumnQuantity"
            role="cell"
            data-label="{{ 'customer.order.quantity' | t }}"
          >
            x{{ line_item.quantity }}
          </td>
          {% comment %} <td class="pe-4 align-middle">{{ line_item.line_price | money }}</td> {% endcomment %}
          <td class="pe-4 align-middle" headers="RowSubtotal" role="cell" data-label="{{ 'customer.order.subtotal' | t }}">
            {{ order.line_items_subtotal_price | money }}
          </td>
        </tr>
        {% endif %}
        {% endfor %}
        {% if current_collection != '' %}
      </tbody>
      {% endif %}

      {% assign current_collection = '' %}

      {% if current_collection != '' %}
      </tbody>
      {% endif %}

      {%- assign displayed_stock_on_hand = false -%}
      {% for line_item in sorted_items %}
      {% unless line_item.product.collections.first.title contains '[Pre-Order]' %}
      {%- if displayed_stock_on_hand == false -%}
      <tr>
        <td></td>
        <td class="collection-title p-0 align-middle fs-3 text-start py-3" colspan="5"
          style="background-color: lightgoldenrodyellow;">
          Stock On Hand</td>
      </tr>
      {%- assign displayed_stock_on_hand = true -%}
      {%- endif -%}

      <tr>
        <td></td>
        <td class="p-0 text-center align-middle">
          <img src="{{ line_item.image | image_url: width: 100, height: 100 }}" alt="{{ line_item.title }}" width="100"
            height="100" class="clickable-img" data-bs-toggle="modal" data-bs-target="#imageModal"
            data-img-src="{{ line_item.image | image_url }}" data-img-alt="{{ line_item.title }}">
        </td>
          {% comment %} <td class="ps-3 align-middle">{{ line_item.product.title }}</td> {% endcomment %}
          <td class="ps-3 align-top" id="Row{{ line_item.key }}" headers="ColumnProduct" role="rowheader" scope="row"
            data-label="{{ 'customer.order.product' | t }}">
            <div>
              {%- if line_item.url != blank -%}
              <!-- å¦‚æœç”¢å“æœ‰URLï¼Œé¡¯ç¤ºç‚ºå¯é»æ“Šéˆæ¥ -->
              <a href="{{ line_item.url }}">{{ line_item.title }}</a>
              {%- else -%}
              <!-- å¦å‰‡é¡¯ç¤ºç‚ºæ™®é€šæ–‡æœ¬ -->
              <p>{{ line_item.title }}</p>
              {%- endif -%}
              {%- assign property_size = line_item.properties | size -%}
              {%- unless line_item.selling_plan_allocation == null and property_size == 0 -%}
              <div class="properties">
                {%- unless line_item.product.has_only_default_variant -%}
                <!-- å¦‚æœç”¢å“æœ‰è®Šé«”ï¼Œé¡¯ç¤ºè®Šé«”åç¨± -->
                <span>
                  {{ line_item.variant.title }}
                </span>
                {%- endunless -%}
                {%- unless line_item.selling_plan_allocation == null -%}
                <!-- å¦‚æœæœ‰éŠ·å”®è¨ˆåŠƒï¼Œé¡¯ç¤ºè¨ˆåŠƒåç¨± -->
                <span>
                  {{ line_item.selling_plan_allocation.selling_plan.name }}
                </span>
                {%- endunless -%}
                {%- if property_size != 0 -%}
                <!-- é¡¯ç¤ºç”¢å“å±¬æ€§ -->
                {%- for property in line_item.properties -%}
                {% assign property_first_char = property.first | slice: 0 %}
                {%- if property.last != blank and property_first_char != '_' -%}
                <span>{{ property.first }}:</span>
                <span>
                  {%- if property.last contains '/uploads/' -%}
                  <a href="{{ property.last }}">{{ property.last | split: '/' | last }}</a>
                  {%- else -%}
                  {{ property.last }}
                  {%- endif -%}
                </span>
                {%- endif -%}
                {%- endfor -%}
                {%- endif -%}
              </div>
              {%- endunless -%}

              {%- if line_item.line_level_discount_allocations != blank -%}
              <!-- å¦‚æœæœ‰æŠ˜æ‰£ï¼Œé¡¯ç¤ºæŠ˜æ‰£ä¿¡æ¯ -->
              <ul role="list" aria-label="{{ 'customer.order.discount' | t }}">
                {%- for discount_allocation in line_item.line_level_discount_allocations -%}
                <li>
                  <svg aria-hidden="true" focusable="false" viewBox="0 0 12 12">
                    <use href="#icon-discount" />
                  </svg>
                  {{- discount_allocation.discount_application.title }} (-
                  {{- discount_allocation.amount | money -}}
                  )
                </li>
                {%- endfor -%}
              </ul>
              {%- endif -%}

              {%- if line_item.fulfillment -%}
              <div class="fulfillment">
                {%- assign created_at = line_item.fulfillment.created_at | time_tag: format: 'date' -%}
                <!-- é¡¯ç¤ºå±¥è¡Œæ—¥æœŸ -->
                <span>{{ 'customer.order.fulfilled_at_html' | t: date: created_at }}</span>

                {%- if line_item.fulfillment.tracking_url -%}
                <!-- å¦‚æœæœ‰è¿½è¹¤URLï¼Œé¡¯ç¤ºè¿½è¹¤éˆæ¥ -->
                <a href="{{ line_item.fulfillment.tracking_url }}">
                  {{ 'customer.order.track_shipment' | t }}
                </a>
                {%- endif -%}
                <span>
                  {{ line_item.fulfillment.tracking_company }}
                  {%- if line_item.fulfillment.tracking_number -%}
                  #{{ line_item.fulfillment.tracking_number }}
                  {%- endif -%}
                </span>
              </div>
              {%- endif -%}
            </div>
          </td>

        <td class="pe-4 align-middle">{{ line_item.final_price | money }}</td>
        <td class="text-center align-middle">x{{ line_item.quantity }}</td>
        <td class="pe-4 align-middle">{{ order.line_items_subtotal_price | money }}</td>
      </tr>
      {% endunless %}
      {% endfor %}
      </tbody>
      <tfoot role="rowgroup">
        <tr role="row">
          <!-- è¨‚å–®å°è¨ˆ -->
          <td id="RowSubtotal" role="rowheader" scope="row" colspan="4">
            {{ 'customer.order.subtotal' | t }}
          </td>
          <td headers="RowSubtotal" role="cell" data-label="{{ 'customer.order.subtotal' | t }}">
            {{ order.line_items_subtotal_price | money }}
          </td>
        </tr>
        {%- if order.cart_level_discount_applications != blank -%}
        <tr role="row">
          {%- for discount_application in order.cart_level_discount_applications -%}
          <td id="RowDiscount" role="rowheader" scope="row" colspan="4">
            {{ 'customer.order.discount' | t }}
            <span class="cart-discount">
              <svg aria-hidden="true" focusable="false" viewBox="0 0 12 12">
                <use href="#icon-discount" />
              </svg>
              {{- discount_application.title -}}
            </span>
          </td>
          <td headers="RowDiscount" role="cell" data-label="{{ 'customer.order.discount' | t }}">
            <div>
              <span>-{{ discount_application.total_allocated_amount | money }}</span>
              <span class="cart-discount">
                <svg aria-hidden="true" focusable="false" viewBox="0 0 12 12">
                  <use href="#icon-discount" />
                </svg>
                {{- discount_application.title -}}
              </span>
            </div>
          </td>
          {%- endfor -%}
        </tr>
        {%- endif -%}
        {%- for shipping_method in order.shipping_methods -%}
        <tr role="row">
          <!-- é¡¯ç¤ºé‹è²» -->
          <td id="RowShipping" role="rowheader" scope="row" colspan="4">
            {{ 'customer.order.shipping' | t }} ({{ shipping_method.title }})
          </td>
          <td headers="RowShipping" role="cell"
            data-label="{{ 'customer.order.shipping' | t }} ({{ shipping_method.title }})">
            {{ shipping_method.price | money }}
          </td>
        </tr>
        {%- endfor -%}
        {%- for tax_line in order.tax_lines -%}
        <tr role="row">
          <!-- é¡¯ç¤ºç¨…é‡‘ -->
          <td id="RowTax" role="rowheader" scope="row" colspan="4">
            {{ 'customer.order.tax' | t }} ({{ tax_line.title }}
            {{ tax_line.rate | times: 100 }}%)
          </td>
          <td headers="RowTax" role="cell"
            data-label="{{ 'customer.order.tax' | t }} ({{ tax_line.title }} {{ tax_line.rate | times: 100 }}%)">
            {{ tax_line.price | money }}
          </td>
        </tr>
        {%- endfor -%}
        {%- if order.total_duties -%}
        <tr role="row">
          <!-- é¡¯ç¤ºé—œç¨… -->
          <td id="RowDuties" role="rowheader" scope="row" colspan="4">{{ 'customer.order.total_duties' | t }}</td>
          <td headers="RowDuties" role="cell" data-label="{{ 'customer.order.total_duties' | t }}">
            {{ order.total_duties | money }}
          </td>
        </tr>
        {%- endif -%}
        {%- if order.total_refunded_amount > 0 -%}
        <tr role="row">
          <!-- é¡¯ç¤ºé€€æ¬¾ç¸½é¡ -->
          <td id="RowTotalRefund" role="rowheader" scope="row" colspan="3">
            {{ 'customer.order.total_refunded' | t }}
          </td>
          <td headers="RowTotalRefund" role="cell" colspan="2" data-label="{{ 'customer.order.total_refunded' | t }}">
            -{{ order.total_refunded_amount | money_with_currency }}
          </td>
        </tr>
        {%- endif -%}
        <tr role="row">
          <!-- é¡¯ç¤ºè¨‚å–®ç¸½é¡ -->
          <td id="RowTotal" role="rowheader" scope="row" colspan="3">{{ 'customer.order.total' | t }}</td>
          <td headers="RowTotal" role="cell" colspan="2" data-label="{{ 'customer.order.total' | t }}">
            {{ order.total_net_amount | money_with_currency }}
          </td>
        </tr>
      </tfoot>

    </table>

    {% comment %} Mobile Table {% endcomment %}
    <table class="table order-summary-table d-table d-md-none" style="padding: 0%;">
      <thead>
        <tr>
          <th class="py-4 fs-4 text-center" style="width: 40px;"></th>
          <th class="py-4 fs-4 text-start">Image / Product Info</th>
          <th class="py-4 fs-4 text-end" style="width: 100px;">Price x Qty = Total</th>
        </tr>
      </thead>
      <tbody>
        {% assign current_collection = '' %}
        {% for line_item in sorted_items %}
        {% assign collection = line_item.product.collections[0].title %}
        {% if collection contains '[Pre-Order]' %}
        {% if collection != current_collection %}
        {% if current_collection != '' %}
      </tbody>
      {% endif %}
      {% assign current_collection = collection %}
      <tr>
        <td class="text text-start align-middle py-2" style="padding-right:0;background-color:lightgoldenrodyellow;">
          <a class="btn btn-primary toggle-button text-decoration-none align-middle" style="padding-top:1rem;"
            data-bs-toggle="collapse" data-bs-target="#collapse{{ forloop.index }}" href="#collapse{{ forloop.index }}"
            role="button" aria-expanded="true" aria-controls="collapse{{ forloop.index }}">
            â•
          </a>
          <Span div class="text text-start py-3">
            {{ collection }}
            {%- assign product = line_item.product -%}
            {%- assign collection_handle = product.collections[0].handle -%}
            {%- assign shopify_collection = collections[collection_handle] -%}
            {% if shopify_collection.metafields.custom.estimated_time_of_arrival %}
            <span class="badge rounded-pill text-white bg-primary text-center align-middle">
              ETA: {{ shopify_collection.metafields.custom.estimated_time_of_arrival | date: '%Y-%m-%d' }}
            </span>
            {% endif %}
          </Span>
        </td>
      </tr>
      <tbody id="collapse{{ forloop.index }}" class="collapse">
        {% endif %}
        <tr class="py-2">
          <td class="p-0 text-start align-middle">
            <img src="{{ line_item.image | image_url: width: 75, height: 75 }}" alt="{{ line_item.title }}" width="75"
              height="75" class="clickable-img" data-bs-toggle="modal" data-bs-target="#imageModal"
              data-img-src="{{ line_item.image | image_url }}" data-img-alt="{{ line_item.title }}">
            {% comment %} {{ line_item.product.title }} {% endcomment %}
            <div>
              {%- if line_item.url != blank -%}
              <!-- å¦‚æœç”¢å“æœ‰URLï¼Œé¡¯ç¤ºç‚ºå¯é»æ“Šéˆæ¥ -->
              <a href="{{ line_item.url }}">{{ line_item.title }}</a>
              {%- else -%}
              <!-- å¦å‰‡é¡¯ç¤ºç‚ºæ™®é€šæ–‡æœ¬ -->
              <p>{{ line_item.title }}</p>
              {%- endif -%}
              {%- assign property_size = line_item.properties | size -%}
              {%- unless line_item.selling_plan_allocation == null and property_size == 0 -%}
              <div class="properties">
                {%- unless line_item.product.has_only_default_variant -%}
                <!-- å¦‚æœç”¢å“æœ‰è®Šé«”ï¼Œé¡¯ç¤ºè®Šé«”åç¨± -->
                <span>
                  {{ line_item.variant.title }}
                </span>
                {%- endunless -%}
                {%- unless line_item.selling_plan_allocation == null -%}
                <!-- å¦‚æœæœ‰éŠ·å”®è¨ˆåŠƒï¼Œé¡¯ç¤ºè¨ˆåŠƒåç¨± -->
                <span>
                  {{ line_item.selling_plan_allocation.selling_plan.name }}
                </span>
                {%- endunless -%}
                {%- if property_size != 0 -%}
                <!-- é¡¯ç¤ºç”¢å“å±¬æ€§ -->
                {%- for property in line_item.properties -%}
                {% assign property_first_char = property.first | slice: 0 %}
                {%- if property.last != blank and property_first_char != '_' -%}
                <span>{{ property.first }}:</span>
                <span>
                  {%- if property.last contains '/uploads/' -%}
                  <a href="{{ property.last }}">{{ property.last | split: '/' | last }}</a>
                  {%- else -%}
                  {{ property.last }}
                  {%- endif -%}
                </span>
                {%- endif -%}
                {%- endfor -%}
                {%- endif -%}
              </div>
              {%- endunless -%}

              {%- if line_item.line_level_discount_allocations != blank -%}
              <!-- å¦‚æœæœ‰æŠ˜æ‰£ï¼Œé¡¯ç¤ºæŠ˜æ‰£ä¿¡æ¯ -->
              <ul role="list" aria-label="{{ 'customer.order.discount' | t }}">
                {%- for discount_allocation in line_item.line_level_discount_allocations -%}
                <li>
                  <svg aria-hidden="true" focusable="false" viewBox="0 0 12 12">
                    <use href="#icon-discount" />
                  </svg>
                  {{- discount_allocation.discount_application.title }} (-
                  {{- discount_allocation.amount | money -}}
                  )
                </li>
                {%- endfor -%}
              </ul>
              {%- endif -%}

              {%- if line_item.fulfillment -%}
              <div class="fulfillment">
                {%- assign created_at = line_item.fulfillment.created_at | time_tag: format: 'date' -%}
                <!-- é¡¯ç¤ºå±¥è¡Œæ—¥æœŸ -->
                <span>{{ 'customer.order.fulfilled_at_html' | t: date: created_at }}</span>

                {%- if line_item.fulfillment.tracking_url -%}
                <!-- å¦‚æœæœ‰è¿½è¹¤URLï¼Œé¡¯ç¤ºè¿½è¹¤éˆæ¥ -->
                <a href="{{ line_item.fulfillment.tracking_url }}">
                  {{ 'customer.order.track_shipment' | t }}
                </a>
                {%- endif -%}
                <span>
                  {{ line_item.fulfillment.tracking_company }}
                  {%- if line_item.fulfillment.tracking_number -%}
                  #{{ line_item.fulfillment.tracking_number }}
                  {%- endif -%}
                </span>
              </div>
              {%- endif -%}
            </div>





          </td>
          <td class="p-1 border-bottom border-dark">
            <div class="w-100">
              <h3>{{ line_item.final_price | money }} x {{ line_item.quantity }} = {{ order.line_items_subtotal_price | money }}</h3>
            </div>
          </td>
        </tr>
        {% endif %}
        {% endfor %}
        {% if current_collection != '' %}
      </tbody>
      {% endif %}

      {% assign current_collection = '' %}

      {% if current_collection != '' %}
      </tbody>
      {% endif %}

      {%- assign displayed_stock_on_hand = false -%}
      {% for line_item in sorted_items %}
      {% unless line_item.product.collections.first.title contains '[Pre-Order]' %}
      {%- if displayed_stock_on_hand == false -%}
      <tr>
        <td class="collection-title p-0 align-middle fs-3 text-start py-3" colspan="3"
          style="background-color: lightgoldenrodyellow;">
          Stock On Hand</td>
      </tr>
      {%- assign displayed_stock_on_hand = true -%}
      {%- endif -%}

      <tr class="py-2">
        <td class="p-0 text-start align-middle">
          <img src="{{ line_item.image | image_url: width: 75, height: 75 }}" alt="{{ line_item.title }}" width="75"
            height="75" class="clickable-img" data-bs-toggle="modal" data-bs-target="#imageModal"
            data-img-src="{{ line_item.image | image_url }}" data-img-alt="{{ line_item.title }}">
          {% comment %} {{ line_item.product.title }} {% endcomment %}
          <div>
            {%- if line_item.url != blank -%}
            <!-- å¦‚æœç”¢å“æœ‰URLï¼Œé¡¯ç¤ºç‚ºå¯é»æ“Šéˆæ¥ -->
            <a href="{{ line_item.url }}">{{ line_item.title }}</a>
            {%- else -%}
            <!-- å¦å‰‡é¡¯ç¤ºç‚ºæ™®é€šæ–‡æœ¬ -->
            <p>{{ line_item.title }}</p>
            {%- endif -%}
            {%- assign property_size = line_item.properties | size -%}
            {%- unless line_item.selling_plan_allocation == null and property_size == 0 -%}
            <div class="properties">
              {%- unless line_item.product.has_only_default_variant -%}
              <!-- å¦‚æœç”¢å“æœ‰è®Šé«”ï¼Œé¡¯ç¤ºè®Šé«”åç¨± -->
              <span>
                {{ line_item.variant.title }}
              </span>
              {%- endunless -%}
              {%- unless line_item.selling_plan_allocation == null -%}
              <!-- å¦‚æœæœ‰éŠ·å”®è¨ˆåŠƒï¼Œé¡¯ç¤ºè¨ˆåŠƒåç¨± -->
              <span>
                {{ line_item.selling_plan_allocation.selling_plan.name }}
              </span>
              {%- endunless -%}
              {%- if property_size != 0 -%}
              <!-- é¡¯ç¤ºç”¢å“å±¬æ€§ -->
              {%- for property in line_item.properties -%}
              {% assign property_first_char = property.first | slice: 0 %}
              {%- if property.last != blank and property_first_char != '_' -%}
              <span>{{ property.first }}:</span>
              <span>
                {%- if property.last contains '/uploads/' -%}
                <a href="{{ property.last }}">{{ property.last | split: '/' | last }}</a>
                {%- else -%}
                {{ property.last }}
                {%- endif -%}
              </span>
              {%- endif -%}
              {%- endfor -%}
              {%- endif -%}
            </div>
            {%- endunless -%}

            {%- if line_item.line_level_discount_allocations != blank -%}
            <!-- å¦‚æœæœ‰æŠ˜æ‰£ï¼Œé¡¯ç¤ºæŠ˜æ‰£ä¿¡æ¯ -->
            <ul role="list" aria-label="{{ 'customer.order.discount' | t }}">
              {%- for discount_allocation in line_item.line_level_discount_allocations -%}
              <li>
                <svg aria-hidden="true" focusable="false" viewBox="0 0 12 12">
                  <use href="#icon-discount" />
                </svg>
                {{- discount_allocation.discount_application.title }} (-
                {{- discount_allocation.amount | money -}}
                )
              </li>
              {%- endfor -%}
            </ul>
            {%- endif -%}

            {%- if line_item.fulfillment -%}
            <div class="fulfillment">
              {%- assign created_at = line_item.fulfillment.created_at | time_tag: format: 'date' -%}
              <!-- é¡¯ç¤ºå±¥è¡Œæ—¥æœŸ -->
              <span>{{ 'customer.order.fulfilled_at_html' | t: date: created_at }}</span>

              {%- if line_item.fulfillment.tracking_url -%}
              <!-- å¦‚æœæœ‰è¿½è¹¤URLï¼Œé¡¯ç¤ºè¿½è¹¤éˆæ¥ -->
              <a href="{{ line_item.fulfillment.tracking_url }}">
                {{ 'customer.order.track_shipment' | t }}
              </a>
              {%- endif -%}
              <span>
                {{ line_item.fulfillment.tracking_company }}
                {%- if line_item.fulfillment.tracking_number -%}
                #{{ line_item.fulfillment.tracking_number }}
                {%- endif -%}
              </span>
            </div>
            {%- endif -%}
          </div>
        </td>
        <td class="p-1 border-bottom border-dark">
          <div class="w-100">
            <h3>{{ line_item.final_price | money }} x {{ line_item.quantity }} = {{ order.line_items_subtotal_price | money }}</h3>
          </div>
        </td>
      </tr>

      {% endunless %}
      {% endfor %}
      </tbody>
      <tfoot role="rowgroup">
        <tr role="row">
          <!-- è¨‚å–®å°è¨ˆ -->
          <td id="RowSubtotal" role="rowheader" scope="row" colspan="4">
            {{ 'customer.order.subtotal' | t }}
          </td>
          <td headers="RowSubtotal" role="cell" data-label="{{ 'customer.order.subtotal' | t }}">
            {{ order.line_items_subtotal_price | money }}
          </td>
        </tr>
        {%- if order.cart_level_discount_applications != blank -%}
        <tr role="row">
          {%- for discount_application in order.cart_level_discount_applications -%}
          <td id="RowDiscount" role="rowheader" scope="row" colspan="4">
            {{ 'customer.order.discount' | t }}
            <span class="cart-discount">
              <svg aria-hidden="true" focusable="false" viewBox="0 0 12 12">
                <use href="#icon-discount" />
              </svg>
              {{- discount_application.title -}}
            </span>
          </td>
          <td headers="RowDiscount" role="cell" data-label="{{ 'customer.order.discount' | t }}">
            <div>
              <span>-{{ discount_application.total_allocated_amount | money }}</span>
              <span class="cart-discount">
                <svg aria-hidden="true" focusable="false" viewBox="0 0 12 12">
                  <use href="#icon-discount" />
                </svg>
                {{- discount_application.title -}}
              </span>
            </div>
          </td>
          {%- endfor -%}
        </tr>
        {%- endif -%}
        {%- for shipping_method in order.shipping_methods -%}
        <tr role="row">
          <!-- é¡¯ç¤ºé‹è²» -->
          <td id="RowShipping" role="rowheader" scope="row" colspan="4">
            {{ 'customer.order.shipping' | t }} ({{ shipping_method.title }})
          </td>
          <td headers="RowShipping" role="cell"
            data-label="{{ 'customer.order.shipping' | t }} ({{ shipping_method.title }})">
            {{ shipping_method.price | money }}
          </td>
        </tr>
        {%- endfor -%}
        {%- for tax_line in order.tax_lines -%}
        <tr role="row">
          <!-- é¡¯ç¤ºç¨…é‡‘ -->
          <td id="RowTax" role="rowheader" scope="row" colspan="4">
            {{ 'customer.order.tax' | t }} ({{ tax_line.title }}
            {{ tax_line.rate | times: 100 }}%)
          </td>
          <td headers="RowTax" role="cell"
            data-label="{{ 'customer.order.tax' | t }} ({{ tax_line.title }} {{ tax_line.rate | times: 100 }}%)">
            {{ tax_line.price | money }}
          </td>
        </tr>
        {%- endfor -%}
        {%- if order.total_duties -%}
        <tr role="row">
          <!-- é¡¯ç¤ºé—œç¨… -->
          <td id="RowDuties" role="rowheader" scope="row" colspan="4">{{ 'customer.order.total_duties' | t }}</td>
          <td headers="RowDuties" role="cell" data-label="{{ 'customer.order.total_duties' | t }}">
            {{ order.total_duties | money }}
          </td>
        </tr>
        {%- endif -%}
        {%- if order.total_refunded_amount > 0 -%}
        <tr role="row">
          <!-- é¡¯ç¤ºé€€æ¬¾ç¸½é¡ -->
          <td id="RowTotalRefund" role="rowheader" scope="row" colspan="3">
            {{ 'customer.order.total_refunded' | t }}
          </td>
          <td headers="RowTotalRefund" role="cell" colspan="2" data-label="{{ 'customer.order.total_refunded' | t }}">
            -{{ order.total_refunded_amount | money_with_currency }}
          </td>
        </tr>
        {%- endif -%}
        <tr role="row">
          <!-- é¡¯ç¤ºè¨‚å–®ç¸½é¡ -->
          <td id="RowTotal" role="rowheader" scope="row" colspan="3">{{ 'customer.order.total' | t }}</td>
          <td headers="RowTotal" role="cell" colspan="2" data-label="{{ 'customer.order.total' | t }}">
            {{ order.total_net_amount | money_with_currency }}
          </td>
        </tr>
      </tfoot>

    </table>


    <!-- æ¨¡æ…‹æ¡†çµæ§‹ -->
    <div class="modal fade" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-body">
            <img src="{{ line_item.image | image_url }}" alt="{{ line_item.title }}" width="100%" height="auto"
              class="img-fluid" data-bs-toggle="modal" data-bs-target="#imageModal"
              data-img-src="{{ line_item.image | image_url }}" data-img-alt="{{ line_item.title }}">
          </div>
        </div>
      </div>
    </div>
    {% comment %}
    <div class="line-item-table" style="margin-top:2rem;">
      <table role="table" class="order-details">
        <!-- è¡¨æ ¼æ¨™é¡Œï¼Œéš±è—æ–¼è¦–è¦ºä½†å°æ–¼è¼”åŠ©æŠ€è¡“å¯è¦‹ -->
        <caption class="visually-hidden">
          {{ 'customer.order.title' | t: name: order.name }}
        </caption>
        <thead role="rowgroup">
          <tr role="row">
            <th id="ColumnCollapse"></th>
            <th id="ColumnImage" scope="col" role="columnheader">{{ 'customer.order.image' | t }}</th>
            <th id="ColumnProduct" scope="col" role="columnheader">{{ 'customer.order.product' | t }}</th>
            <!-- <th id="ColumnSku" scope="col" role="columnheader">{{ 'customer.order.sku' | t }}</th> -->
            <th id="ColumnPrice" scope="col" role="columnheader">{{ 'customer.order.price' | t }}</th>
            <th id="ColumnQuantity" scope="col" role="columnheader">{{ 'customer.order.quantity' | t }}</th>
            <th id="ColumnTotal" scope="col" role="columnheader">{{ 'customer.order.total' | t }}</th>
          </tr>
        </thead>
        <tbody role="rowgroup">
          {%- for line_item in order.line_items -%}
          <tr role="row">
            <td id="Row{{ line_item.key }}" headers="ColumnProduct" role="rowheader" scope="row"
              data-label="{{ 'customer.order.product' | t }}">
              <div>
                {%- if line_item.url != blank -%}
                <!-- å¦‚æœç”¢å“æœ‰URLï¼Œé¡¯ç¤ºç‚ºå¯é»æ“Šéˆæ¥ -->
                <a href="{{ line_item.url }}">{{ line_item.title }}</a>
                {%- else -%}
                <!-- å¦å‰‡é¡¯ç¤ºç‚ºæ™®é€šæ–‡æœ¬ -->
                <p>{{ line_item.title }}</p>
                {%- endif -%}
                {%- assign property_size = line_item.properties | size -%}
                {%- unless line_item.selling_plan_allocation == null and property_size == 0 -%}
                <div class="properties">
                  {%- unless line_item.product.has_only_default_variant -%}
                  <!-- å¦‚æœç”¢å“æœ‰è®Šé«”ï¼Œé¡¯ç¤ºè®Šé«”åç¨± -->
                  <span>
                    {{ line_item.variant.title }}
                  </span>
                  {%- endunless -%}
                  {%- unless line_item.selling_plan_allocation == null -%}
                  <!-- å¦‚æœæœ‰éŠ·å”®è¨ˆåŠƒï¼Œé¡¯ç¤ºè¨ˆåŠƒåç¨± -->
                  <span>
                    {{ line_item.selling_plan_allocation.selling_plan.name }}
                  </span>
                  {%- endunless -%}
                  {%- if property_size != 0 -%}
                  <!-- é¡¯ç¤ºç”¢å“å±¬æ€§ -->
                  {%- for property in line_item.properties -%}
                  {% assign property_first_char = property.first | slice: 0 %}
                  {%- if property.last != blank and property_first_char != '_' -%}
                  <span>{{ property.first }}:</span>
                  <span>
                    {%- if property.last contains '/uploads/' -%}
                    <a href="{{ property.last }}">{{ property.last | split: '/' | last }}</a>
                    {%- else -%}
                    {{ property.last }}
                    {%- endif -%}
                  </span>
                  {%- endif -%}
                  {%- endfor -%}
                  {%- endif -%}
                </div>
                {%- endunless -%}

                {%- if line_item.line_level_discount_allocations != blank -%}
                <!-- å¦‚æœæœ‰æŠ˜æ‰£ï¼Œé¡¯ç¤ºæŠ˜æ‰£ä¿¡æ¯ -->
                <ul role="list" aria-label="{{ 'customer.order.discount' | t }}">
                  {%- for discount_allocation in line_item.line_level_discount_allocations -%}
                  <li>
                    <svg aria-hidden="true" focusable="false" viewBox="0 0 12 12">
                      <use href="#icon-discount" />
                    </svg>
                    {{- discount_allocation.discount_application.title }} (-
                    {{- discount_allocation.amount | money -}}
                    )
                  </li>
                  {%- endfor -%}
                </ul>
                {%- endif -%}

                {%- if line_item.fulfillment -%}
                <div class="fulfillment">
                  {%- assign created_at = line_item.fulfillment.created_at | time_tag: format: 'date' -%}
                  <!-- é¡¯ç¤ºå±¥è¡Œæ—¥æœŸ -->
                  <span>{{ 'customer.order.fulfilled_at_html' | t: date: created_at }}</span>

                  {%- if line_item.fulfillment.tracking_url -%}
                  <!-- å¦‚æœæœ‰è¿½è¹¤URLï¼Œé¡¯ç¤ºè¿½è¹¤éˆæ¥ -->
                  <a href="{{ line_item.fulfillment.tracking_url }}">
                    {{ 'customer.order.track_shipment' | t }}
                  </a>
                  {%- endif -%}
                  <span>
                    {{ line_item.fulfillment.tracking_company }}
                    {%- if line_item.fulfillment.tracking_number -%}
                    #{{ line_item.fulfillment.tracking_number }}
                    {%- endif -%}
                  </span>
                </div>
                {%- endif -%}
              </div>
            </td>
            <td headers="Row{{ line_item.key }} ColumnSku" role="cell" data-label="{{ 'customer.order.sku' | t }}">
              <!-- é¡¯ç¤ºç”¢å“SKU -->
              {{ line_item.sku }}
            </td>
            <td headers="Row{{ line_item.key }} ColumnPrice" role="cell" data-label="{{ 'customer.order.price' | t }}">
              <!-- é¡¯ç¤ºç”¢å“åƒ¹æ ¼ï¼Œå¦‚æœæœ‰æŠ˜æ‰£é¡¯ç¤ºæŠ˜æ‰£å¾Œåƒ¹æ ¼ -->
              {%- if line_item.original_price != line_item.final_price or line_item.unit_price_measurement -%}
              <dl>
                {%- if line_item.original_price != line_item.final_price -%}
                <dt>
                  <span class="visually-hidden">{{ 'products.product.price.regular_price' | t }}</span>
                </dt>
                <dd class="regular-price">
                  <s>{{ line_item.original_price | money }}</s>
                </dd>
                <dt>
                  <span class="visually-hidden">{{ 'products.product.price.sale_price' | t }}</span>
                </dt>
                <dd>
                  <span>{{ line_item.final_price | money }}</span>
                </dd>
                {%- else -%}
                <dt>
                  <span class="visually-hidden">{{ 'products.product.price.regular_price' | t }}</span>
                </dt>
                <dd>
                  {{ line_item.original_price | money }}
                </dd>
                {%- endif -%}
                {%- if line_item.unit_price_measurement -%}
                <dt>
                  <span class="visually-hidden">{{ 'products.product.price.unit_price' | t }}</span>
                </dt>
                <dd class="unit-price">
                  <span>
                    {%- capture unit_price_separator -%}
                    <span aria-hidden="true">/</span><span class="visually-hidden">{{
                      'accessibility.unit_price_separator' | t }}&nbsp;</span>
                    {%- endcapture -%}
                    {%- capture unit_price_base_unit -%}
                    {%- if line_item.unit_price_measurement.reference_value != 1 -%}
                    {{- line_item.unit_price_measurement.reference_value -}}
                    {%- endif -%}
                    {{ line_item.unit_price_measurement.reference_unit }}
                    {%- endcapture -%}
                    <span data-unit-price>{{ line_item.unit_price | money }}</span>
                    {{- unit_price_separator -}}
                    {{- unit_price_base_unit -}}
                  </span>
                </dd>
                {%- endif -%}
              </dl>
              {%- else -%}
              <span>{{ line_item.final_price | money }}</span>
              {%- endif -%}
            </td>
            <td headers="Row{{ line_item.key }} ColumnQuantity" role="cell"
              data-label="{{ 'customer.order.quantity' | t }}">
              <!-- é¡¯ç¤ºç”¢å“æ•¸é‡ -->
              {{ line_item.quantity }}
            </td>
            <td headers="Row{{ line_item.key }} ColumnTotal" role="cell" data-label="{{ 'customer.order.total' | t }}">
              <!-- é¡¯ç¤ºç”¢å“ç¸½åƒ¹ï¼Œå¦‚æœæœ‰æŠ˜æ‰£é¡¯ç¤ºæŠ˜æ‰£å¾Œç¸½åƒ¹ -->
              {%- if line_item.original_line_price != line_item.final_line_price -%}
              <dl>
                <dt>
                  <span class="visually-hidden">{{ 'products.product.price.regular_price' | t }}</span>
                </dt>
                <dd class="regular-price">
                  <s>{{ line_item.original_line_price | money }}</s>
                </dd>
                <dt>
                  <span class="visually-hidden">{{ 'products.product.price.sale_price' | t }}</span>
                </dt>
                <dd>
                  <span>{{ line_item.final_line_price | money }}</span>
                </dd>
              </dl>
              {%- else -%}
              {{ line_item.original_line_price | money }}
              {%- endif -%}
            </td>
          </tr>
          {%- endfor -%}
        </tbody>
        <tfoot role="rowgroup">
          <tr role="row">
            <!-- è¨‚å–®å°è¨ˆ -->
            <td id="RowSubtotal" role="rowheader" scope="row" colspan="4">
              {{ 'customer.order.subtotal' | t }}
            </td>
            <td headers="RowSubtotal" role="cell" data-label="{{ 'customer.order.subtotal' | t }}">
              {{ order.line_items_subtotal_price | money }}
            </td>
          </tr>
          {%- if order.cart_level_discount_applications != blank -%}
          <tr role="row">
            {%- for discount_application in order.cart_level_discount_applications -%}
            <td id="RowDiscount" role="rowheader" scope="row" colspan="4">
              {{ 'customer.order.discount' | t }}
              <span class="cart-discount">
                <svg aria-hidden="true" focusable="false" viewBox="0 0 12 12">
                  <use href="#icon-discount" />
                </svg>
                {{- discount_application.title -}}
              </span>
            </td>
            <td headers="RowDiscount" role="cell" data-label="{{ 'customer.order.discount' | t }}">
              <div>
                <span>-{{ discount_application.total_allocated_amount | money }}</span>
                <span class="cart-discount">
                  <svg aria-hidden="true" focusable="false" viewBox="0 0 12 12">
                    <use href="#icon-discount" />
                  </svg>
                  {{- discount_application.title -}}
                </span>
              </div>
            </td>
            {%- endfor -%}
          </tr>
          {%- endif -%}
          {%- for shipping_method in order.shipping_methods -%}
          <tr role="row">
            <!-- é¡¯ç¤ºé‹è²» -->
            <td id="RowShipping" role="rowheader" scope="row" colspan="4">
              {{ 'customer.order.shipping' | t }} ({{ shipping_method.title }})
            </td>
            <td headers="RowShipping" role="cell"
              data-label="{{ 'customer.order.shipping' | t }} ({{ shipping_method.title }})">
              {{ shipping_method.price | money }}
            </td>
          </tr>
          {%- endfor -%}
          {%- for tax_line in order.tax_lines -%}
          <tr role="row">
            <!-- é¡¯ç¤ºç¨…é‡‘ -->
            <td id="RowTax" role="rowheader" scope="row" colspan="4">
              {{ 'customer.order.tax' | t }} ({{ tax_line.title }}
              {{ tax_line.rate | times: 100 }}%)
            </td>
            <td headers="RowTax" role="cell"
              data-label="{{ 'customer.order.tax' | t }} ({{ tax_line.title }} {{ tax_line.rate | times: 100 }}%)">
              {{ tax_line.price | money }}
            </td>
          </tr>
          {%- endfor -%}
          {%- if order.total_duties -%}
          <tr role="row">
            <!-- é¡¯ç¤ºé—œç¨… -->
            <td id="RowDuties" role="rowheader" scope="row" colspan="4">{{ 'customer.order.total_duties' | t }}</td>
            <td headers="RowDuties" role="cell" data-label="{{ 'customer.order.total_duties' | t }}">
              {{ order.total_duties | money }}
            </td>
          </tr>
          {%- endif -%}
          {%- if order.total_refunded_amount > 0 -%}
          <tr role="row">
            <!-- é¡¯ç¤ºé€€æ¬¾ç¸½é¡ -->
            <td id="RowTotalRefund" role="rowheader" scope="row" colspan="3">
              {{ 'customer.order.total_refunded' | t }}
            </td>
            <td headers="RowTotalRefund" role="cell" colspan="2" data-label="{{ 'customer.order.total_refunded' | t }}">
              -{{ order.total_refunded_amount | money_with_currency }}
            </td>
          </tr>
          {%- endif -%}
          <tr role="row">
            <!-- é¡¯ç¤ºè¨‚å–®ç¸½é¡ -->
            <td id="RowTotal" role="rowheader" scope="row" colspan="3">{{ 'customer.order.total' | t }}</td>
            <td headers="RowTotal" role="cell" colspan="2" data-label="{{ 'customer.order.total' | t }}">
              {{ order.total_net_amount | money_with_currency }}
            </td>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>
  {% endcomment %}